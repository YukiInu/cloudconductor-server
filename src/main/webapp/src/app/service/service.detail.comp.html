<div class="row">
  <div class="col-lg-12">
    <h1 class="page-header">Service Details
      <h4 *ngIf="service">{{service.name}}</h4>
    </h1>
  </div>
</div>

<div class="row">

  <div class="col-md-6">
    <div class="panel panel-default">
      <div class="panel-heading">
        <i class="fa fa-list-alt fa-fw"></i> Service-Details
      </div>
      <div class="panel-body">
        <div class="form-group" [class.has-error]="!isNameValid()">
          <label class="control-label" for="name">Name</label>
          <input type="text" class="form-control" [(ngModel)]="service.name" id="name">
        </div>
        <div class="form-group" [class.has-error]="!isScriptValid()">
          <label class="control-label" for="script">Start-Script name</label>
          <input type="text" class="form-control" [(ngModel)]="service.initScript" id="script">
        </div>
        <div class="form-group">
          <label class="control-label" for="description">Description</label>
          <textarea type="text" class="form-control" [(ngModel)]="service.description" id="description"></textarea>
        </div>

        <div class="pull-right">
          <button [routerLink]="['/services']" class="btn btn-default">Back</button>
          <button (click)="save()" class="btn btn-info"
                  [disabled]="!isNameValid() || !isScriptValid()">Save
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="col-md-6">
    <div class="panel panel-default">
      <div class="panel-heading">
        <i class="fa fa-list-alt fa-fw"></i> Provided by package
      </div>
      <div class="panel-body">
        <table class="table-responsive table table-striped table-hover">
          <thead>
          <tr>
            <th>Package-Name</th>
            <th width="15px"></th>
            <th width="15px"></th>
          </tr>
          </thead>
          <tbody>
          <tr *ngFor="let package of service.packages" (dblclick)="gotoPackage(package)">
            <td>
              {{package}}
            </td>
            <td>
              <a [routerLink]="['/package', package]" [queryParams]="{'ret':'serviceDetail', 'id':service.id}"><i
                class="fa fa-external-link fa-fw"></i></a>
            </td>
            <td>
              <a href="javascript:void(0)" mwlConfirm
                 [title]="'Please verify!'"
                 [message]="'Are you sure you want to remove the following package link from the serive: '+ package.name+'?'"
                 placement="left"
                 confirmButtonType="danger"
                 (confirm)="deletePackage(package)">
                <i class="fa fa-bitbucket fa-fw"></i>
              </a>
            </td>
          </tr>

          <tr *ngIf="showAddPackage">
            <td colspan="3">
              <div class="form-group">
                <label class="control-label" for="addpackage"><i class="fa fa-plus fa-fw"></i> Add a package providing this service</label>
                <select class="form-control" [(ngModel)]="newPackage" id="addpackage">
                  <option *ngFor="let pkg of allPackages" value="{{pkg.name}}">{{pkg.name}}</option>
                </select>
              </div>

              <div class="pull-right">
                <button (click)="showAddPackage = false" class="btn btn-default">Abort</button>
                <button (click)="saveNewPackage()" class="btn btn-info"
                        [disabled]="!newPackage">Add
                </button>
              </div>
            </td>
          </tr>

          <tr *ngIf="!showAddPackage" (click)="goToAddPackage()">
            <td colspan="3" role="button"><i class="fa fa-plus fa-fw"></i>
              Add a package providing this service
            </td>
          </tr>

          </tbody>
        </table>
      </div>
    </div>
  </div>

  <div class="col-md-6">
    <div class="panel panel-default">
      <div class="panel-heading">
        <i class="fa fa-list-alt fa-fw"></i> Template references
      </div>
      <div class="panel-body">
        <table class="table-responsive table table-striped table-hover">
          <thead>
          <tr>
            <th width="30%">Template</th>
            <th>Package</th>
            <th width="15px"></th>
          </tr>
          </thead>
          <tbody>
          <tr *ngFor="let ref of templateRefs" (dblclick)="gotoTemplate(ref.template)">
            <td>
              {{ref.template}}
            </td>
            <td class="word-break">
              {{ref.pkg}}
            </td>
            <td>
              <a [routerLink]="['/template', template]" [queryParams]="{'ret':'serviceDetail', 'ref':service.name}"><i
                class="fa fa-external-link fa-fw"></i></a>
            </td>
          </tr>

          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
